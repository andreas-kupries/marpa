# -*- tcl -*- tcl.tk//DSL tcltest//EN//2.0 tcl.tk//DSL tcltest//EN//2.0
## (c) 2018 Andreas Kupries
# # ## ### ##### ######## ############# #####################
## (cparse) rtc-critcl + json.slif
##

##
## Test json parser on top of RT-C.
## 

kt require support critcl   ;# compile & run

# # ## ### ##### ######## ############# #####################
## API to the json-core

proc rt          {} { return c }
proc coding      {} { return binary }
proc constraints {id} {
    #return {} ;# activate to recheck known issues
    if {[dict exists {
	y_string_nonCharacterInUTF-8_U+10FFFF	%
	y_string_nonCharacterInUTF-8_U+1FFFF	%
	y_string_nonCharacterInUTF-8_U+FFFF	%
	y_string_pi				%
	y_string_u+2028_line_sep		%
	y_string_u+2029_par_sep			%
	y_string_unicode_2			%
	y_string_utf8				%

	n_multidigit_number_then_00		%cesu8
	n_object_pi_in_key_and_trailing_comma	%broken-utf
	n_string_unescaped_crtl_char		%cesu8
	n_structure_null-byte-outside-string	%cesu8
	
    } $id]} {
	return knownBug
    }
    return {}
}

# # ## ### ##### ######## ############# #####################
##

kt source common/json-core.testsuite

# # ## ### ##### ######## ############# #####################
cleanupTests
